machine:
  environment:
    DATABASE_URL: postgres://ubuntu@localhost:5432/circle_test
    NODE_ENV: development
    SPLITWISE_CONSUMER_KEY:
    SPLITWISE_CONSUMER_SECRET:
  node:
    version: 5.1.0
  services:
    - postgresql

dependencies:
  override:
    - npm set progress=false
    - npm install

test:
  override:
    - npm run build:server
    - npm run build:client
    - npm run test:unit -- --reporter mocha-junit-reporter --reporter-options mochaFile=$CIRCLE_TEST_REPORTS/mocha/unit.xml
    - npm run test:lint -- -o $CIRCLE_TEST_REPORTS/lint/eslint.xml -f junit

general:
  artifacts:
    - "out/buildstats.json"